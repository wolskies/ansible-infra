---
- name: Test discovery role
  hosts: all
  gather_facts: true
  tasks:
    - name: Run discovery role
      ansible.builtin.include_role:
        name: wolskies.infrastructure.discovery

    - name: Debug discovered udev rules
      ansible.builtin.debug:
        var: discovered_udev_rules
      when: discovered_udev_rules is defined

    - name: Debug discovered macOS preferences
      ansible.builtin.debug:
        var: discovered_macos_preferences
      when: discovered_macos_preferences is defined
