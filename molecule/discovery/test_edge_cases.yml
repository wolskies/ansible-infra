---
# Simple edge cases test for discovery
- name: Test discovery edge cases
  hosts: localhost
  gather_facts: false
  vars:
    test_role_path: "{{ playbook_dir }}/../../roles/discovery"
  
  tasks:
    - name: Test template with minimal data
      ansible.builtin.template:
        src: "{{ test_role_path }}/templates/simple_host_vars.yml.j2"
        dest: "/tmp/test-minimal.yml"
      vars:
        config_hostname: "test"
        firewall_enable: false
        host_packages_install_Ubuntu: ['vim']
        users_config: []
        ansible_distribution: "Ubuntu"
      register: minimal_test

    - name: Verify minimal template works
      ansible.builtin.assert:
        that:
          - minimal_test is succeeded
        fail_msg: "Template failed with minimal data"

    - name: Test template with empty values
      ansible.builtin.template:
        src: "{{ test_role_path }}/templates/simple_host_vars.yml.j2"
        dest: "/tmp/test-empty.yml"
      vars:
        ansible_distribution: "Ubuntu"
      register: empty_test

    - name: Verify empty template works
      ansible.builtin.assert:
        that:
          - empty_test is succeeded
        fail_msg: "Template failed with empty values"