---
# Test basic_setup role with discovery data from inventory
- name: Test basic_setup role with discovery data
  hosts: all
  gather_facts: true
  collections:
    - wolskinet.infrastructure

  pre_tasks:
    - name: Update package cache
      ansible.builtin.package:
        update_cache: true
      when: ansible_pkg_mgr in ['apt', 'pacman']

  roles:
    - name: wolskinet.infrastructure.basic_setup

  post_tasks:
    - name: Verify role execution
      ansible.builtin.debug:
        msg: "basic_setup role completed on {{ group_names | join(',') }} {{ ansible_distribution }}"
