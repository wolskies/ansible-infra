---
- name: Converge all systems
  hosts: all
  become: true
  tasks:
    - name: Include os_configuration role
      ansible.builtin.include_role:
        name: wolskies.infrastructure.os_configuration

- name: Configure servers
  hosts: servers
  become: true
  tasks:
    - name: Include manage_security_services role for servers
      ansible.builtin.include_role:
        name: wolskies.infrastructure.manage_security_services
      when:
        - firewall is defined
        - firewall.enabled | default(false)

- name: Configure workstations
  hosts: workstations
  become: true
  tasks:
    - name: Include configure_user role for workstations
      ansible.builtin.include_role:
        name: wolskies.infrastructure.configure_user
      when:
        - install_development_tools | default(false)
