---
- name: Converge all systems
  hosts: all
  become: true
  tasks:
    - name: Include configure_operating_system role
      ansible.builtin.include_role:
        name: wolskies.infrastructure.configure_operating_system

- name: Configure servers
  hosts: servers
  become: true
  tasks:
    - name: Configure operating system security for servers
      ansible.builtin.include_role:
        name: wolskies.infrastructure.configure_operating_system
      when:
        - firewall is defined
        - firewall.enabled | default(false)

- name: Configure workstations
  hosts: workstations
  become: true
  tasks:
    - name: Include configure_users role for workstations
      ansible.builtin.include_role:
        name: wolskies.infrastructure.configure_users
      when:
        - install_development_tools | default(false)
