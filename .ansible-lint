---
# .ansible-lint configuration file
# This file configures ansible-lint to catch common errors and maintain code quality

# Paths to exclude from linting
exclude_paths:
  - .venv/
  - .ansible/
  - .github/
  - molecule/*/create.yml
  - molecule/*/destroy.yml
  - molecule/*/prepare.yml
  - molecule/shared/molecule-base.yml
  - tests/

# Enable additional rules for better error detection
enable_list:
  - args
  - empty-string-compare
  - no-log-password
  - no-same-owner
  - yaml[colons]
  - yaml[commas]
  - yaml[empty-lines]
  - yaml[key-duplicates]
  - yaml[new-line-at-end-of-file]
  - yaml[octal-values]
  - yaml[trailing-spaces]
  - yaml[truthy]

# Rules to skip (if needed for specific cases)
skip_list:
  - schema[meta]  # Allow flexible meta/main.yml schemas
  - name[missing]  # Some generated tasks might not have names
  - var-naming[no-role-prefix]  # Allow variables without role prefix for compatibility
  - var-naming[pattern]  # Allow distribution-based variable names like host_packages_install_Ubuntu
  - key-order  # Allow flexible key ordering in tasks
  - command-instead-of-module  # Allow using shell/command for specific tools like rustup
  - risky-shell-pipe  # Allow shell pipes for legitimate use cases
  - no-changed-when  # Allow commands without changed_when for handlers/checks
  - meta-incorrect  # Allow flexible meta information in development
  - package-latest  # Allow latest packages in development environments
  - latest[git]  # Allow git latest for development setups
  - risky-file-permissions  # Allow flexible file permissions for user files
  - name[casing]  # Allow flexible handler naming
  - jinja[spacing]  # Allow flexible jinja spacing (warnings only)

# Set stricter standards
strict: true

# Ansible-lint profiles (use production for strictest checking)
profile: production

# Use ansible syntax check
use_default_rules: true

# Parseable output for CI integration
parseable: true

# Display relative paths
display_relative_path: true

# Custom rule directories (if we add any)
# rulesdir:
#   - ./custom-ansible-rules/

# Set variable naming patterns
var_naming_pattern: "^[a-z_][a-z0-9_]*$"

# Mock modules and roles to prevent missing module errors
mock_modules:
  - community.general.timezone
  - community.general.locale_gen
  - community.general.npm
  - community.general.pacman
  - community.general.homebrew
  - community.general.homebrew_cask
  - community.general.homebrew_tap
  - community.general.osx_defaults
  - community.general.pam_limits
  - community.general.ufw
  - community.general.snap
  - community.general.flatpak
  - community.general.flatpak_remote
  - community.general.git_config

mock_roles:
  - wolskinet.infrastructure.configure_host
  - wolskinet.infrastructure.manage_packages
  - wolskinet.infrastructure.manage_users
  - wolskinet.infrastructure.manage_firewall
  - wolskinet.infrastructure.discovery
  - wolskinet.infrastructure.dotfiles
  - wolskinet.infrastructure.manage_language_packages
  - wolskinet.infrastructure.manage_system_settings

# Offline mode - don't download schemas
offline: true
