---
# =============================================================================
# DOTFILES MANAGEMENT
# =============================================================================
# This role manages user dotfiles deployment from git repositories or local files
#
# Supports:
# - Git repository cloning and updating
# - GNU Stow for symlink management
# - Direct symlink deployment
# - Automatic backup of existing files
# - Multi-user deployment

# =============================================================================
# DOTFILES DEPLOYMENT CONFIGURATION
# =============================================================================
dotfiles:
  # Single user deployment (simple mode)
  user: "" # Username (required if not using users list)
  repository_url: "" # Git repository URL (required)
  repository_branch: "main" # Git branch to use
  repository_dest: ".dotfiles" # Destination directory (relative to user home)

  # Deployment method
  method: "auto" # auto, stow, symlink, copy
  stow_packages: [] # Stow packages to deploy (empty = all)
  backup_conflicts: true # Backup existing files that conflict with stow deployment
  ignore_conflicts: false # Continue deployment even if stow reports conflicts

  # Backup configuration
  backup:
    enabled: true # Backup existing files before deployment
    suffix: ".backup" # Backup file suffix
    timestamp: true # Add timestamp to backup suffix

  # Update behavior
  update:
    enabled: false # Update existing repository on each run
    force: false # Force update (may overwrite local changes)

  # Multi-user deployment (advanced mode)
  users: [] # List of user configurations
  # Example:
  # users:
  #   - name: alice
  #     repository_url: "https://github.com/alice/dotfiles"
  #     repository_branch: "main"
  #     method: "stow"
  #     stow_packages: ["bash", "vim", "tmux"]
  #   - name: bob
  #     repository_url: "https://github.com/bob/dotfiles"
  #     method: "symlink"

  # Files to manage when not using stow (symlink/copy methods)
  files:
    - ".bashrc"
    - ".bash_profile"
    - ".zshrc"
    - ".vimrc"
    - ".tmux.conf"
    - ".gitconfig"
    - ".config/nvim"

  # Validation
  validate:
    check_stow: true # Check if stow is installed when needed
    check_git: true # Check if git is installed
