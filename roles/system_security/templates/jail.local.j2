# Fail2Ban configuration
# Generated by wolskinet.infrastructure.system_security role

[DEFAULT]
# Ban hosts for one hour:
bantime = {{ fail2ban_services[0].bantime | default(3600) }}

# Override /etc/fail2ban/jail.d/00-firewalld.conf:
banaction = iptables-multiport

# A host is banned after 5 failures within 10 minutes
findtime = {{ fail2ban_services[0].findtime | default(600) }}
maxretry = {{ fail2ban_services[0].maxretry | default(5) }}

# Ignore local IPs
ignoreip = {{ fail2ban_ignoreips | join(' ') }}

# Email settings (disabled by default)
#mta = sendmail
#action = %(action_)s

{% for service in fail2ban_services %}
{% if service.enabled %}
[{{ service.name }}]
enabled = true
maxretry = {{ service.maxretry | default(5) }}
{% if service.bantime is defined %}
bantime = {{ service.bantime }}
{% endif %}
{% if service.findtime is defined %}
findtime = {{ service.findtime }}
{% endif %}
{% endif %}

{% endfor %}