---
# =============================================================================
# SECURITY SERVICES ROLE VARIABLES
# =============================================================================
# Distribution-specific security services configuration
# =============================================================================

infrastructure:
  Ubuntu:
    firewall:
      enabled: false
      prevent_ssh_lockout: true
      package: "ufw"
      rules: []
      # Rule examples:
      # - rule: allow
      #   port: 80
      #   proto: tcp
      #   comment: "HTTP traffic"
    fail2ban:
      enabled: false
      sender: "root@localhost"
      dest_email: ""
      defaults:
        bantime: 3600
        findtime: 600
        maxretry: 5
      services:
        - name: sshd
          enabled: true
          maxretry: 5
          bantime: 3600
          findtime: 600
          logpath: /var/log/auth.log
      ignoreips:
        - "127.0.0.1/8"
        - "::1"
        
  Debian:
    firewall:
      enabled: false
      prevent_ssh_lockout: true
      package: "ufw"
      rules: []
    fail2ban:
      enabled: false
      sender: "root@localhost"
      dest_email: ""
      defaults:
        bantime: 3600
        findtime: 600
        maxretry: 5
      services:
        - name: sshd
          enabled: true
          maxretry: 5
          bantime: 3600
          findtime: 600
          logpath: /var/log/auth.log
      ignoreips:
        - "127.0.0.1/8"
        - "::1"
        
  Archlinux:
    firewall:
      enabled: false
      prevent_ssh_lockout: true
      package: "ufw"
      rules: []
    fail2ban:
      enabled: false
      sender: "root@localhost"
      dest_email: ""
      defaults:
        bantime: 3600
        findtime: 600
        maxretry: 5
      services:
        - name: sshd
          enabled: true
          maxretry: 5
          bantime: 3600
          findtime: 600
          logpath: /var/log/auth.log
      ignoreips:
        - "127.0.0.1/8"
        - "::1"
        
  Darwin:
    firewall:
      enabled: false
      package: "macos_alf"
      stealth_mode: false
      block_all: false
      logging: false
    # Note: fail2ban not supported on macOS

