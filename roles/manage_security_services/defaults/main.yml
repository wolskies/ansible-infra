---
# =============================================================================
# FIREWALL SERVICE MANAGEMENT (OS INSTALLATION)
# =============================================================================
# Control via tags: --tags firewall-services

security_firewall_common:
  enabled: true
  start: true
  default_rules:
    - rule: allow
      port: "22"
      protocol: tcp
      comment: "SSH access (prevent lockout)"

security_firewall_linux:
  package: "ufw"

security_firewall_macosx:
  package: "macos_alf"
  stealth_mode: false
  block_all: false
  logging: false

# =============================================================================
# FAIL2BAN INTRUSION PREVENTION
# =============================================================================
# Control via tags: --tags fail2ban

security_fail2ban_common:
  enabled: true
  start: true
  sender: "root@localhost"
  dest_email: ""

security_fail2ban_defaults:
  bantime: 3600                         # 1 hour
  findtime: 600                         # 10 minutes
  maxretry: 5

security_fail2ban_services:
  - name: sshd
    enabled: true
    maxretry: 5
    bantime: 3600
    findtime: 600
    logpath: /var/log/auth.log

security_fail2ban_ignoreips:
  - "127.0.0.1/8"
  - "::1"

# =============================================================================
# FUTURE SECURITY SERVICES
# =============================================================================

security_intrusion_detection_enabled: false
security_log_monitoring_enabled: false
security_audit_enabled: false
