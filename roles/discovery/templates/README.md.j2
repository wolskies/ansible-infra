# Infrastructure Discovery Report

**Source**: {{ discovered_machine.hostname }} ({{ discovered_machine.type }})  
**Date**: {{ discovered_machine.discovered_at }}  
**OS**: {{ discovered_system.os.distribution }} {{ discovered_system.os.version }}

## Discovery Results

**Packages**: {{ discovered_packages.total | default(0) }} found
{% if discovered_packages.development_packages %}
**Development Tools**: {{ discovered_packages.development_packages | length }} packages detected
{% endif %}

**Services**: {{ discovered_services.running | default([]) | length }} running

{% if discovered_docker.installed %}
**Docker**: Installed
- Compose: {{ 'Available' if discovered_docker.compose.available else 'Not available' }}
- Services found: {{ discovered_docker.services.total | default(0) }}
{% if discovered_docker.services.canned %}
- Canned services: {{ discovered_docker.services.canned_roles | join(', ') }}
{% endif %}
{% if discovered_docker.services.generic %}
- Generic services: {{ discovered_docker.services.generic | length }}
{% endif %}
{% endif %}


{% if discovered_dotfiles.users_with_dotfiles | default([]) | length > 0 %}
**Dotfiles**: Found for {{ discovered_dotfiles.users_with_dotfiles | length }}/{{ discovered_dotfiles.total_users_scanned }} users
{% if discovered_dotfiles.primary_dotfiles.repository_detected %}
- Primary: {{ discovered_dotfiles.primary_dotfiles.user }} (repository: {{ discovered_dotfiles.primary_dotfiles.repository_url }})
{% elif discovered_dotfiles.primary_dotfiles.local_configs_detected %}
- Primary: {{ discovered_dotfiles.primary_dotfiles.user }} (local configs)
{% endif %}
{% endif %}

## Generated Files

- `host_vars/{{ inventory_hostname }}.yml` - Host-specific variables for your inventory
- `{{ inventory_hostname }}_discovered.yml` - Deployment playbook for this host

## Next Steps

1. Review generated host_vars file for accuracy
2. Uncomment desired roles in the deployment playbook
3. Configure vault variables for sensitive data
4. Deploy: `ansible-playbook {{ inventory_hostname }}_discovered.yml`

## File Locations

The discovery role respects your ansible.cfg configuration:
- Host variables: Added to your configured inventory directory
- Playbook: Created in your configured playbooks directory