---
# Host Variables for {{ inventory_hostname }}
# Generated by wolskinet.infrastructure.discovery role
# Machine Type: {{ discovered_machine.type }}
# 
# IMPORTANT: These are DISCOVERED packages/services from the source machine.
# They will be ADDED to global and group variables (not override them).
# Edit this file to customize what gets installed on this specific host.

# === DISCOVERED CONFIGURATION ===
# Packages found on the source machine

{% if discovered_docker.installed %}
# Docker Service Configuration
docker_service_deploy:
{% for service in discovered_docker.suggested_services %}
# - {{ service }}-docker  # Discovered: {{ service }}
{% endfor %}

docker_detected: true
docker_version: "{{ discovered_docker.version }}"
{% if discovered_docker.containers.total > 0 %}
docker_containers_running: {{ discovered_docker.containers.total }}
{% endif %}

{% endif %}
{% if discovered_users.dotfiles.detected %}
# Dotfiles Configuration
{% if discovered_users.dotfiles.repository_url %}
dotfiles_repository_url: "{{ discovered_users.dotfiles.repository_url }}"
{% endif %}
{% if discovered_users.dotfiles.current_branch %}
dotfiles_branch: "{{ discovered_users.dotfiles.current_branch }}"
{% endif %}
{% if discovered_users.dotfiles.management_tools %}
dotfiles_management_tools:
{% for tool in discovered_users.dotfiles.management_tools %}
  - "{{ tool }}"
{% endfor %}
{% endif %}

{% endif %}
{% if discovered_users.shell_config.preferred_shell and discovered_users.shell_config.preferred_shell != '/bin/bash' %}
# Shell Configuration
default_user_shell: "{{ discovered_users.shell_config.preferred_shell }}"
shell_config_files_detected:
{% for config in discovered_users.shell_config.config_files %}
  - "{{ config }}"
{% endfor %}

{% endif %}
{% if discovered_repositories.apt.additional_sources %}
# APT Repository Configuration
apt_additional_sources: {{ discovered_repositories.apt.additional_sources | length }}

{% endif %}
{% if discovered_repositories.pacman.aur_helpers %}
# AUR Configuration (Arch Linux)
aur_helper: "{{ discovered_repositories.pacman.aur_helpers[0] }}"
{% if discovered_packages.aur_packages %}
aur_packages_count: {{ discovered_packages.aur_packages | length }}
{% endif %}

{% endif %}
{% if discovered_repositories.homebrew.taps %}
# Homebrew Configuration (macOS)
homebrew_taps_detected: {{ discovered_repositories.homebrew.taps | length }}

{% endif %}
{% if discovered_security.ssh.service_running %}
# SSH Configuration
ssh_service_detected: true
{% if discovered_security.ssh.settings.port and discovered_security.ssh.settings.port != '22' %}
ssh_port_custom: {{ discovered_security.ssh.settings.port }}
{% endif %}

{% endif %}
# System Information (for reference)
discovered_info:
  os: "{{ discovered_system.os.distribution }} {{ discovered_system.os.version }}"
  architecture: "{{ discovered_system.os.architecture }}"
  memory_mb: {{ discovered_system.hardware.memory_mb }}
  cpu_cores: {{ discovered_system.hardware.cpu_cores }}
  packages_total: {{ discovered_packages.total }}
  services_running: {{ discovered_services.running | length }}
  machine_type: "{{ discovered_machine.type }}"
  discovery_date: "{{ ansible_date_time.iso8601 }}"

# TODO: Review and uncomment Docker service entries
# TODO: Configure service-specific settings
# TODO: Set up vault variables for sensitive data