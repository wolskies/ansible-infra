---
# Data Processing - Simplified
# Creates summary variables for role integration

- name: Create machine summary
  ansible.builtin.set_fact:
    discovered_machine:
      hostname: "{{ discovered_system.hostname }}"
      type: >-
        {%- if discovered_docker.installed | default(false) -%}
          docker_host
        {%- else -%}
          server
        {%- endif %}
      discovered_at: "{{ ansible_date_time.iso8601 }}"

- name: Display discovery processing summary
  ansible.builtin.debug:
    msg:
      - "=== Discovery Processing Complete ==="
      - "Hostname: {{ discovered_machine.hostname }}"
      - "Machine Type: {{ discovered_machine.type }}"
      - "Docker Detected: {{ discovered_docker.installed | default(false) }}"
      - "Packages Found: {{ discovered_packages.all_native | default([]) | length }}"
      - "Services Running: {{ discovered_services.running | default([]) | length }}"
  tags:
    - processing
    - summary
