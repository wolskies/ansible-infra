---
# Configure user preferences
# Accepts either: target_user (single user) or users (list of users)

- name: Configure preferences for each user
  ansible.builtin.include_tasks: configure-single-user.yml
  vars:
    target_user: "{{ current_user }}"
  loop: "{{ user_list if user_list is defined else [target_user] }}"
  loop_control:
    loop_var: current_user
  when:
    - current_user.name is defined
    - current_user.name != 'root' # Skip system accounts
