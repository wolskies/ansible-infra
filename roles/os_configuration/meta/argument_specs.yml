---
argument_specs:
  main:
    short_description: OS configuration management role
    description: |
      Handles fundamental operating system configuration including hostname, timezone,
      locale, NTP, systemd services/modules, journal, security hardening, and OS-specific
      configurations.
    options:
      # Domain/System Configuration
      domain_name:
        type: str
        default: ""
        description: Organization domain name (RFC 1035 format, e.g., "example.com")

      domain_timezone:
        type: str
        default: ""
        description: System timezone (IANA format, e.g., "America/New_York", "Europe/London")

      domain_locale:
        type: str
        default: "en_US.UTF-8"
        description: "System locale (format: language_COUNTRY.encoding, e.g., en_US.UTF-8, fr_FR.UTF-8)"

      domain_language:
        type: str
        default: "en_US.UTF-8"
        description: System language (locale format, e.g., "en_US.UTF-8", "de_DE.UTF-8")

      # Host Configuration
      host_hostname:
        type: str
        default: ""
        description: System hostname (RFC 1123 format, alphanumeric + hyphens, max 253 chars)

      host_update_hosts:
        type: bool
        default: true
        description: Update /etc/hosts with hostname entry

      # Systemd Services
      host_services:
        type: dict
        default: {}
        description: Systemd service management configuration
        options:
          enable:
            type: list
            elements: str
            default: []
            description: Systemd service names to enable (e.g., ["nginx", "postgresql"])
          disable:
            type: list
            elements: str
            default: []
            description: Systemd service names to disable (e.g., ["apache2", "sendmail"])
          mask:
            type: list
            elements: str
            default: []
            description: Systemd service names to mask (e.g., ["snapd", "telnet"])

      # Kernel Modules
      host_modules:
        type: dict
        default: {}
        description: Kernel module management configuration
        options:
          load:
            type: list
            elements: str
            default: []
            description: Kernel modules to load persistently (e.g., ["br_netfilter", "overlay"])
          blacklist:
            type: list
            elements: str
            default: []
            description: Kernel modules to blacklist (e.g., ["pcspkr", "snd_pcsp"])

      # Udev Rules
      host_udev_rules:
        type: list
        elements: dict
        default: []
        description: Custom udev rules definitions
        options:
          name:
            type: str
            required: true
            description: Rule identifier (alphanumeric + hyphens, used in filename)
          content:
            type: str
            required: true
            description: 'Udev rule content (e.g., ''SUBSYSTEM=="usb", MODE="0666"'')'
          priority:
            type: int
            default: 99
            description: Rule priority (10-99, lower executes first)
          state:
            type: str
            default: "present"
            choices: ["present", "absent"]
            description: Rule state ("present" to deploy, "absent" to remove)

      # Time Synchronization Configuration
      domain_timesync:
        type: dict
        default: {}
        description: Time synchronization configuration via systemd-timesyncd
        options:
          enabled:
            type: bool
            default: false
            description: Enable time synchronization configuration
          servers:
            type: list
            elements: str
            default: []
            description: Time server hostnames/IPs (e.g., ["pool.ntp.org", "time.google.com"])

      # Journal Configuration
      journal:
        type: dict
        default: {}
        description: Systemd journal configuration management
        options:
          configure:
            type: bool
            default: false
            description: Enable systemd journal configuration management
          max_size:
            type: str
            default: "500M"
            description: Maximum disk space for journal files (e.g., "500M", "1G", "2G")
          max_retention:
            type: str
            default: "30d"
            description: Maximum journal retention time (e.g., "7d", "30d", "1y")
          forward_to_syslog:
            type: bool
            default: false
            description: Forward journal messages to syslog daemon
          compress:
            type: bool
            default: true
            description: Enable journal file compression

      # Security Configuration
      hardening:
        type: dict
        default: {}
        description: Security hardening configuration
        options:
          os_hardening_enabled:
            type: bool
            default: false
            description: Enable devsec.hardening.os_hardening security baseline
          ssh_hardening_enabled:
            type: bool
            default: false
            description: Enable devsec.hardening.ssh_hardening security hardening

      # APT Configuration (Debian/Ubuntu)
      apt:
        type: dict
        default: {}
        description: APT package manager configuration
        options:
          proxy:
            type: str
            default: ""
            description: "APT proxy URL (format: http[s]://[user:pass@]host:port, e.g., http://user:pass@proxy.company.com:8080)"
          no_recommends:
            type: bool
            default: false
            description: Disable APT automatic installation of recommended and suggested packages
          unattended_upgrades:
            type: dict
            default: {}
            description: APT unattended upgrades configuration
            options:
              enabled:
                type: bool
                default: false
                description: Enable APT unattended security upgrades on Debian/Ubuntu systems
          system_upgrade:
            type: dict
            default: {}
            description: APT system upgrade configuration
            options:
              enable:
                type: bool
                default: false
                description: Enable APT system upgrades (security, dist-upgrade, etc.)
              type:
                type: str
                default: "safe"
                choices: ["safe", "dist", "full", "yes"]
                description: APT upgrade type

      # Pacman Configuration (Arch Linux)
      pacman:
        type: dict
        default: {}
        description: Pacman package manager configuration
        options:
          proxy:
            type: str
            default: ""
            description: "Pacman proxy URL (format: http[s]://[user:pass@]host:port, e.g., http://proxy.example.com:3128)"
          no_confirm:
            type: bool
            default: false
            description: Enable Pacman NoConfirm option (skip confirmation prompts on Arch Linux systems)
          multilib:
            type: dict
            default: {}
            description: Pacman multilib repository configuration
            options:
              enabled:
                type: bool
                default: false
                description: Enable Pacman multilib repository for 32-bit packages on Arch Linux systems
          enable_aur:
            type: bool
            default: false
            description: Enable AUR (Arch User Repository) package support with paru helper

      # macOS Configuration
      macosx:
        type: dict
        default: {}
        description: macOS system configuration
        options:
          updates:
            type: dict
            default: {}
            description: macOS software update configuration
            options:
              auto_check:
                type: bool
                default: true
                description: Enable automatic checking for macOS software updates
              auto_download:
                type: bool
                default: true
                description: Enable automatic downloading of macOS software updates
          gatekeeper:
            type: dict
            default: {}
            description: macOS Gatekeeper configuration
            options:
              enabled:
                type: bool
                default: true
                description: Enable macOS Gatekeeper security feature (prevents unsigned application execution)
          system_preferences:
            type: dict
            default: {}
            description: macOS system preferences configuration
            options:
              natural_scroll:
                type: bool
                default: true
                description: Enable natural scroll direction (reverse scrolling) on macOS
              measurement_units:
                type: str
                default: "Inches"
                choices: ["Inches", "Centimeters"]
                description: System measurement units
              use_metric:
                type: bool
                default: false
                description: Use metric system for measurements and temperatures
              show_all_extensions:
                type: bool
                default: false
                description: Show all file extensions in Finder
          airdrop:
            type: dict
            default: {}
            description: macOS AirDrop configuration
            options:
              ethernet_enabled:
                type: bool
                default: false
                description: Enable AirDrop over Ethernet interfaces (BrowseAllInterfaces setting)
