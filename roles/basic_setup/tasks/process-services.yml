---
# Process additional services from inventory
# This is optional and disabled by default

- name: Enable services
  ansible.builtin.systemd:
    name: "{{ item }}"
    enabled: true
    state: started
  become: true
  loop: "{{ final_services_enable | default([]) }}"
  when:
    - ansible_os_family != 'Darwin'
    - final_services_enable is defined
  tags:
    - services
    - enable-services

- name: Disable services
  ansible.builtin.systemd:
    name: "{{ item }}"
    enabled: false
    state: stopped
  become: true
  loop: "{{ final_services_disable | default([]) }}"
  when:
    - ansible_os_family != 'Darwin'
    - final_services_disable is defined
  ignore_errors: true
  tags:
    - services
    - disable-services
