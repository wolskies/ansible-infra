---
# manage_system_settings role handlers

# Linux handlers
- name: Update initramfs
  ansible.builtin.command:
    cmd: update-initramfs -u
  become: true
  when:
    - ansible_distribution in ['Ubuntu', 'Debian']
    - ansible_virtualization_type != 'docker'
  failed_when: false

- name: Update mkinitcpio
  ansible.builtin.command:
    cmd: mkinitcpio -P
  become: true
  when:
    - ansible_distribution == 'Archlinux'
    - ansible_virtualization_type != 'docker'
  failed_when: false

# macOS handlers
- name: Restart Dock
  ansible.builtin.command:
    cmd: killall Dock
  when: ansible_os_family == 'Darwin'

- name: Restart Finder
  ansible.builtin.command:
    cmd: killall Finder
  when: ansible_os_family == 'Darwin'

- name: Restart SystemUIServer
  ansible.builtin.command:
    cmd: killall SystemUIServer
  when: ansible_os_family == 'Darwin'

- name: Update font cache
  ansible.builtin.command:
    cmd: fc-cache -fv
  become: true
  when: ansible_os_family == 'Debian'
  changed_when: false
