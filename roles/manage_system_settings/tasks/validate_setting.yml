---
# Parameterized validation task
- name: "Validate {{ validation_rule.type }}"
  ansible.builtin.fail:
    msg: "{{ validation_rule.error }}: {{ item if item is string else item.key if item.key is defined else item }}"
  loop: "{{ validation_rule.check_items | default([]) }}"
  when:
    - not (security_bypass.all_validation | default(false))
    - not (security_bypass[validation_rule.bypass] | default(false)) if validation_rule.bypass is defined
    - validation_rule.condition | default(true)
  tags:
    - security
    - validation
    - "{{ validation_rule.type }}"
