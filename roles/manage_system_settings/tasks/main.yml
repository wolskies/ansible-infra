---
# manage_system_settings role main tasks
# System-level performance tuning and hardware configurations

- name: Validate supported OS versions
  ansible.builtin.fail:
    msg: >-
      {{ ansible_distribution }} {{ ansible_distribution_version }}
      is not supported. Supported versions: Ubuntu 24+, Debian 12+,
      Arch Linux (latest)
  when:
    - >-
      (ansible_distribution == "Ubuntu" and
      ansible_distribution_major_version | int < 24) or
      (ansible_distribution == "Debian" and
      ansible_distribution_major_version | int < 12)
  tags:
    - always
    - validation
    - system-settings

- name: Load OS-specific variables
  ansible.builtin.include_vars: "{{ ansible_distribution }}.yml"
  when: ansible_distribution in ['Ubuntu', 'Debian', 'Archlinux']
  tags:
    - always
    - variables
    - system-settings

- name: Include OS-specific system settings tasks
  ansible.builtin.include_tasks: "settings-{{ ansible_distribution }}.yml"
  when: ansible_distribution in ['Ubuntu', 'Debian', 'Archlinux']
  tags:
    - always
    - system-settings
    - optimization
