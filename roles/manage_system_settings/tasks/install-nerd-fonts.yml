---
# Quick & Dirty Nerd Fonts Installation for Ubuntu/Debian
# Downloads, unzips, and installs fonts from provided URLs
# Skips installation on Arch Linux and macOS (use package managers instead)

- name: Skip nerd fonts installation on Arch/macOS
  ansible.builtin.debug:
    msg: "Skipping nerd fonts installation - use package manager instead (pacman/homebrew)"
  when:
    - system_config_nf_enable | bool
    - ansible_distribution in ["Archlinux"] or ansible_system == "Darwin"
  tags:
    - fonts
    - nerd-fonts

- name: Create nerd fonts installation directory
  ansible.builtin.file:
    path: "{{ system_config_nf_install_dir }}"
    state: directory
    mode: '0755'
  become: true
  when:
    - system_config_nf_enable | bool
    - ansible_os_family in ["Debian"]
  tags:
    - fonts
    - nerd-fonts

- name: Download and extract nerd fonts
  ansible.builtin.unarchive:
    src: "{{ item }}"
    dest: "{{ system_config_nf_install_dir }}"
    remote_src: true
    owner: root
    group: root
    mode: '0644'
  loop: "{{ system_config_nf_links }}"
  become: true
  when:
    - system_config_nf_enable | bool
    - ansible_os_family in ["Debian"]
  notify: Update font cache
  tags:
    - fonts
    - nerd-fonts

- name: Display nerd fonts installation status
  ansible.builtin.debug:
    msg:
      - "=== Nerd Fonts Installation Completed ==="
      - "Downloaded {{ system_config_nf_links | length }} font archives"
      - "Installation directory: {{ system_config_nf_install_dir }}"
      - "Font cache will be updated automatically"
  when:
    - system_config_nf_enable | bool
    - ansible_os_family in ["Debian"]
  tags:
    - fonts
    - nerd-fonts
