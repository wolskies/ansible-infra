---
# Manages firewall rules
# Supports: Ubuntu 22+, Debian 12+, Arch Linux, macOS

# =============================================================================
# FIREWALL RULE CONFIGURATION
# =============================================================================

# Core rule management
firewall_manage_rules: true            # Whether to manage firewall rules
firewall_type: "auto"                  # auto, ufw, firewalld, iptables, pf
firewall_reset_to_defaults: false      # Reset firewall rules before applying new ones

# Rule behavior
firewall_logging: false                # Enable firewall logging
firewall_log_level: low                # Logging level (low, medium, high, full)
firewall_ipv6_enabled: true            # Apply rules to IPv6 as well

# =============================================================================
# ACCESS CONTROL
# =============================================================================

# Simple port lists (recommended for basic configurations)
firewall_allowed_ports: []             # List of ports to allow (e.g., ["80", "443"])
firewall_allowed_services: []          # List of service names (e.g., ["http", "https"])
                                        # Note: SSH is always allowed automatically to prevent lockout

# Denied ports and services
firewall_denied_ports: []              # List of ports to explicitly deny
firewall_denied_services: []           # List of services to explicitly deny

# Advanced port configuration
firewall_custom_rules: []              # Complex rules with source restrictions
# Example:
# firewall_custom_rules:
#   - rule: allow                       # allow, deny, reject, limit
#     port: 3306
#     protocol: tcp
#     source: "10.0.1.0/24"
#     comment: "MySQL from app subnet"
#   - rule: allow
#     port: 6379
#     protocol: tcp
#     source: "192.168.1.0/24"
#     comment: "Redis from local network"
#   - rule: allow
#     name: "OpenSSH"
#     comment: "SSH access"

# Rate limiting
firewall_rate_limit_enabled: false     # Enable connection rate limiting
firewall_rate_limit_burst: 6           # Burst connections allowed
firewall_rate_limit_seconds: 30        # Time window for rate limiting

# =============================================================================
# PLATFORM-SPECIFIC FEATURES
# =============================================================================

# OS-specific tool preferences
firewall_tool_preference:
  Ubuntu: "ufw"                         # Ubuntu Uncomplicated Firewall
  Debian: "ufw"                         # UFW is common on Debian
  Archlinux: "ufw"                      # UFW is commonly used on Arch
  MacOSX: "macos_alf"                   # macOS Application Layer Firewall (rule management only)
