---
# manage_firewall main tasks
# Pure firewall rule management - assumes firewall service is already installed and configured

- name: Validate supported platforms
  ansible.builtin.fail:
    msg: >-
      {{ ansible_distribution }} is not supported.
      Supported: Ubuntu 22+, Debian 12+, Arch Linux
  when:
    - ansible_system == 'Linux'
    - ansible_distribution not in ['Ubuntu', 'Debian', 'Archlinux']
  tags:
    - always
    - validation
    - firewall

- name: Apply firewall rules (UFW backend)
  ansible.builtin.include_tasks: firewall-ufw.yml
  when:
    - ansible_system == 'Linux'
    - firewall_backend == 'ufw'
  tags:
    - firewall
    - firewall-rules

# Future: Add support for other backends
# - name: Apply firewall rules (firewalld backend)
#   ansible.builtin.include_tasks: firewall-firewalld.yml
#   when:
#     - ansible_system == 'Linux'
#     - firewall_backend == 'firewalld'
#   tags:
#     - firewall
#     - firewall-rules
