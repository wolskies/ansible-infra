---
# macOS Application Layer Firewall management
# Limited port management - SSH handled by Remote Login system preferences

- name: Enable macOS Application Layer Firewall
  ansible.builtin.command: /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on
  become: true
  changed_when: true

- name: Configure macOS firewall logging
  ansible.builtin.command: log config --subsystem com.apple.alf --mode "level:{{ 'debug' if firewall_logging | default(false) else 'off' }}"
  become: true
  when: firewall_logging is defined
  changed_when: true
  failed_when: false  # Log configuration might not be available on all macOS versions
