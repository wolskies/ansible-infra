---
# Server-specific variables
# These are ADDITIVE to global variables

# Additional packages for servers (OS-specific)
group_packages_install_Ubuntu:
  # Server essentials
  - fail2ban
  - unattended-upgrades
  - logrotate
  - rsyslog
  - chrony
  - nginx
  - docker.io
  - docker-compose
  - ufw
  # Monitoring
  - htop
  - iotop

group_packages_install_Debian:
  # Server essentials
  - fail2ban
  - unattended-upgrades
  - logrotate
  - rsyslog
  - chrony
  - nginx
  - docker.io
  - docker-compose
  - ufw
  # Monitoring
  - htop
  - iotop

group_packages_install_Archlinux:
  # Server essentials
  - fail2ban
  - logrotate
  - rsyslog
  - chrony
  - nginx
  - docker
  - docker-compose
  - ufw
  # Monitoring
  - htop
  - iotop

# Packages to remove on servers (minimize attack surface, OS-specific)
group_packages_remove_Ubuntu:
  - games-common
  - avahi-daemon     # Not needed on servers
  - cups             # No printing on servers

group_packages_remove_Debian:
  - games-common
  - avahi-daemon     # Not needed on servers
  - cups             # No printing on servers

group_packages_remove_Archlinux:
  - cups             # No printing on servers

# Services for servers
group_services_enable:
  - ssh
  - fail2ban
  - rsyslog
  - chrony
  - ufw
  - docker

group_services_disable:
  - avahi-daemon
  - cups
  - bluetooth

# Server-specific roles
group_roles_install:
  - basic_setup
  - maintenance
  - security_hardening
  - container_platform

# Security hardening configuration
security_hardening_enabled: true

# Enhanced security defaults for servers
enable_firewall: true
disable_unnecessary_services: true
disable_snapd_stop_service: true  # Ubuntu servers typically don't need snap
disable_snapd_uninstall_snapd: false  # Set to true if you want to completely remove snap

# Server-specific SSH hardening
ssh_server_hardening:
  disable_root_login: true
  disable_password_auth: true  # Use key-based auth only
  max_auth_tries: 3
  client_alive_interval: 300
  client_alive_count_max: 2

# System resource limits for servers
system_limits:
  - domain: "*"
    type: soft
    item: nofile
    value: 65536
  - domain: "*"
    type: hard
    item: nofile
    value: 65536

# Server monitoring and logging
enable_system_monitoring: true
log_retention_days: 30

# Automatic security updates (servers should be up-to-date)
enable_automatic_updates: true
reboot_if_required: false  # Set to true for automatic reboots during maintenance windows

# Network security
fail2ban_enabled: true
ufw_default_deny_incoming: true
ufw_default_allow_outgoing: true

# Required server packages (in addition to basic packages)
server_packages:
  Ubuntu:
    - fail2ban
    - unattended-upgrades
    - logrotate
    - rsyslog
    - chrony
  Debian:
    - fail2ban
    - unattended-upgrades
    - logrotate
    - rsyslog
    - chrony
  Archlinux:
    - fail2ban
    - logrotate
    - rsyslog
    - chrony

# Service configurations
systemd_services:
  enable:
    - ssh
    - fail2ban
    - rsyslog
    - chrony
  disable:
    - avahi-daemon  # Not typically needed on servers
    - cups  # Print services not needed on servers

# File system security
mount_options:
  - device: "tmpfs"
    path: "/tmp"
    fstype: "tmpfs"
    opts: "defaults,nodev,nosuid,noexec,size=1G"
    state: "mounted"

# Docker services for servers (will be merged with all-level services)
group_docker_services_deploy:
  - nginx_proxy_manager  # Reverse proxy management
  - portainer            # Docker management interface

# Additional Docker networks for servers (will be merged with all-level networks)
group_docker_networks:
  - name: "web"
    driver: "bridge"
    enable_ipv6: false
  - name: "services"
    driver: "bridge" 
    enable_ipv6: false

# Server-specific Docker daemon configuration (overrides all-level config)
group_docker_daemon_config:
  log-driver: "journald"
  log-opts:
    max-size: "50m"
    max-file: "5"
  storage-driver: "overlay2"