---
- name: Configure workstations with desktop environment
  hosts: workstations
  gather_facts: true
  collections:
    - wolskinet.infrastructure
    
  vars:
    # Desktop packages for workstations (handled by extra_packages role)
    desktop_packages:
      - firefox
      - gimp
      - vlc
    
    development_packages:
      - code
      
    # Enable desktop package installation
    install_desktop_packages: true
    install_development_packages: true

  roles:
    - name: wolskinet.infrastructure.basic_setup
    - name: wolskinet.infrastructure.extra_packages
    - name: wolskinet.infrastructure.dotfiles
    - name: wolskinet.infrastructure.system_update

  post_tasks:
    - name: Enable desktop login manager (Linux)
      ansible.builtin.systemd:
        name: "{{ display_manager | default('gdm3') }}"
        enabled: true
        state: started
      become: true
      when: ansible_os_family != 'Darwin'